<UserControl x:Class="FollowBot.FollowBotGui"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:controls="http://metro.mahapps.com/winfx/xaml/controls"
             xmlns:settingsPath="clr-namespace:FollowBot"
             mc:Ignorable="d"
             d:DesignHeight="400"
             d:DesignWidth="800">
    <UserControl.Resources>
        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Border x:Name="border" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" VerticalAlignment="Center" HorizontalAlignment="Center" Width="18" Height="18">
                                <Path x:Name="checkMark" Data="M 0 6 L 4 10 L 10 0" StrokeThickness="2" Visibility="Collapsed" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            </Border>
                            <ContentPresenter Grid.Column="1" Margin="5,0,0,0" VerticalAlignment="Center"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="checkMark" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="checkMark" Property="Stroke" Value="{Binding CheckboxColor, FallbackValue=Black}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>
    <Grid DataContext="{x:Static settingsPath:FollowBotSettings.Instance}">
        <TabControl>
            <TabItem Header="General"
                     HorizontalAlignment="Left"
                     VerticalAlignment="Top">
                <ScrollViewer VerticalScrollBarVisibility="Auto"
                              HorizontalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- Follower Settings (Collapsible) -->
                        <Expander Header="Follower Settings" IsExpanded="False" Margin="5">
                            <StackPanel>
                                <Grid Margin="5">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <Label Grid.Row="0" Grid.Column="0" Content="Checkbox Color:" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding CheckboxColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                             MinWidth="100"
                                             ToolTip="Enter color name (Orange, LimeGreen, Yellow, Cyan, White, Gold, etc.) or hex code (#FF6600)"/>
                                </Grid>
                       <WrapPanel Margin="0,5,0,0">
                            <Label Content="Follow Distance:"/>
                            <Label Content="min"/>
                            <TextBox Text="{Binding Path=FollowDistance, Mode=TwoWay}"
                                     MinWidth="25"
                                     MaxWidth="50"
                                     ToolTip="Min follow distance. the follower will try to keep a random distance from the leader between min and max follow distance."/>
                            <Label Content="max"/>
                            <TextBox Text="{Binding Path=MaxFollowDistance, Mode=TwoWay}"
                                     MinWidth="25"
                                     MaxWidth="50"
                                     ToolTip="Max follow distance. the follower will try to keep a random distance from the leader between min and max follow distance."/>
                                </WrapPanel>

                                <Label Content="Party role:   "></Label>
                                <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <CheckBox Grid.Row="0"
                                    Grid.Column="0"
                                    Content="Kill Monsters"
                                    Margin="10,0,10,0"
                                    IsChecked="{Binding Path=ShouldKill, Mode=TwoWay}"
                                    VerticalAlignment="Center"
                                    ToolTip="Should the Follower use the Routine configured skills to fight?"/>
                            <Label Grid.Row="0"
                                    Grid.Column="1"
                                    Content="Max combat Distance:"
                                    VerticalAlignment="Center"/>
                            <TextBox Grid.Row="0"
                                    Grid.Column="2"
                                    Text="{Binding Path=MaxCombatDistance, Mode=TwoWay}"
                                    MinWidth="25"
                                    MaxWidth="50"
                                    VerticalAlignment="Center"
                                    ToolTip="Max distance from the leader, the follower will consider a mob targhetable and so try to fight."/>

                            <CheckBox Grid.Row="1"
                                    Grid.Column="0"
                                    Content="Loot Visible Items"
                                    Margin="10,0,10,0"
                                    IsChecked="{Binding Path=ShouldLoot, Mode=TwoWay}"
                                    VerticalAlignment="Center"
                                    ToolTip="Should the Follower try to loot ALL visible items? PLS NOTE: you nee to use a ingame item filter to reduce the quantity of visible items."/>
                            <Label Grid.Row="1"
                                    Grid.Column="1"
                                    Content="Max loot Distance:"
                                    VerticalAlignment="Center"/>
                            <TextBox Grid.Row="1"
                                    Grid.Column="2"
                                    Text="{Binding Path=MaxLootDistance, Mode=TwoWay}"
                                    MinWidth="25"
                                    MaxWidth="50"
                                    VerticalAlignment="Center"
                                    ToolTip="Max distance from the leader, the follower is allowed to move to loot items. All Items above this distance, will be logged and ignored."/>

                            <CheckBox
                                Grid.Row="2"
                                Grid.Column="0"
                                Margin="10,0,10,0"
                                Content="Loot only quest items"
                                VerticalAlignment="Center"
                                IsChecked="{Binding Path=ShouldLootOnlyQuestItem, Mode=TwoWay}"
                                ToolTip="Work if enable Loot visible item."/>
                            <CheckBox
                            Grid.Row="3"
                            Grid.Column="0"
                            Margin="10,0,10,0"
                            Content="Enable interact quest"
                            VerticalAlignment="Center"
                            IsChecked="{Binding Path=InteractQuest, Mode=TwoWay}"
                            ToolTip="Interact quest object and npc"
                                />
                            <CheckBox
                                Grid.Row="4"
                                Grid.Column="0"
                                Margin="10,0,10,0"
                                Content="Use Stalker Sentinel"
                                IsChecked="{Binding Path=UseStalkerSentinel, Mode=TwoWay}"
                                VerticalAlignment="Center"
                                ToolTip="Use the Stalker Sentinel if equipped and have charged."/>
                            <CheckBox Grid.Row="5"
                                      Grid.Column="0"
                                      Content="Don't Port Out of Map"
                                      Margin="10,0,10,0"
                                      IsChecked="{Binding Path=DontPortOutofMap, Mode=TwoWay}"
                                      VerticalAlignment="Center"
                                      ToolTip="If Enabled, the follower will not try to exit a map if the Leader die or leave the area, you will need to use chat command to leave the area."
                                    Grid.ColumnSpan="3"/>
                            <CheckBox Grid.Row="6"
                                      Grid.Column="0"
                                      Content="Follow in Town"
                                      Margin="10,0,10,0"
                                      IsChecked="{Binding Path=FollowInTown, Mode=TwoWay}"
                                      VerticalAlignment="Center"
                                      ToolTip="If Enabled, the follower will follow the leader in town."/>
                           <CheckBox Grid.Row="7"
                                     Grid.Column="0"
                                     Content="Follow in Hideout"
                                     Margin="10,0,10,0"
                                     IsChecked="{Binding Path=FollowInHideout, Mode=TwoWay}"
                                     VerticalAlignment="Center"
                                     ToolTip="If Enabled, the follower will follow the leader in hideout."/>
                           <CheckBox Grid.Row="8"
                                     Grid.Column="0"
                                     Content="Follow in Heist Hub"
                                     Margin="10,0,10,0"
                                     IsChecked="{Binding Path=FollowInHeistHub, Mode=TwoWay}"
                                     VerticalAlignment="Center"
                                     ToolTip="If Enabled, the follower will follow the leader in Heist Hub."/>
                            <WrapPanel Grid.Row="9"
                                    Grid.Column="0"
                                    Grid.ColumnSpan="3">
                                <Label Content="Teleport Out delay: "
                                        ToolTip="If the Leader Leave the zone for some reason, the bot will wait this numbr of seconds before to leave the map."/>
                                <Slider Name="SlPortOutDelay"
                                        Minimum="0"
                                        Margin="0,5,0,0"
                                        Width="160"
                                        Value="{Binding Path=PortOutThreshold, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        TickFrequency="1"
                                        IsSnapToTickEnabled="True"
                                        SmallChange="1"
                                        LargeChange="1"
                                        Maximum="100"
                                        AutoToolTipPrecision="1"
                                        VerticalAlignment="Center"
                                        ToolTip="If the Leader Leave the zone for some reason, the bot will wait this numbr of seconds before to leave the map."/>
                                <TextBox Name="TbPortOutDelay"
                                        Text="{Binding ElementName=SlPortOutDelay, Path=Value}"
                                        Width="40"
                                        HorizontalAlignment="Left"
                                        Margin="0,5,0,0"
                                        VerticalAlignment="Center"
                                        ToolTip="If the Leader Leave the zone for some reason, the bot will wait this numbr of seconds before to leave the map."/>
                                    <Label Content="Seconds."
                                            ToolTip="If the Leader Leave the zone for some reason, the bot will wait this numbr of seconds before to leave the map."/>
                                </WrapPanel>

                                </Grid>
                                
                                <CheckBox Margin="5"
                                          IsChecked="{Binding AutoReloadPathfinder, Mode=TwoWay}"
                                          Content="Auto-Reload Pathfinder on Terrain Change (Keep Off)"
                                          ToolTip="It is recommended to keep this setting off. Only enable it if you encounter blockades that the bot should be able to move through."/>
                            </StackPanel>
                        </Expander>

                        <!-- Invite/Trade Whitelist (Collapsible) -->
                        <Expander Header="Invite/Trade Whitelist" IsExpanded="False" Margin="5">
                            <StackPanel VerticalAlignment="Top" Margin="0,5,0,0">
                                <TextBlock Text="Manage allowed account names (name#1234) or character names for party invites and trades."
                                           Margin="5" FontStyle="Italic" Foreground="Gray"/>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <Label Grid.Row="0"
                                           Grid.Column="0"
                                           Content="Name to Add: "
                                           Margin="3"
                                           ToolTipService.ToolTip="Enter an account name (name#1234) or character name to add to the whitelist."/>
                                    <TextBox x:Name="InviteTradeWhiteListTextBox"
                                             Grid.Row="0"
                                             Grid.Column="1"
                                             Width="160"/>
                                    <Button x:Name="AddInviteTradeWhiteListButton"
                                            Grid.Row="0"
                                            Grid.Column="2"
                                            Content="Add"
                                            Margin="3,5,3,1"
                                            ToolTipService.ToolTip="Adds the name to the whitelist. Use account name (name#1234) or character name."
                                            Click="AddInviteTradeWhiteListButton_OnClick"/>
                                    <Button x:Name="RemoveInviteTradeWhiteListButton"
                                            Grid.Row="0"
                                            Grid.Column="3"
                                            Content="Remove"
                                            Margin="3,5,3,1"
                                            ToolTipService.ToolTip="Removes the selected name from the whitelist."
                                            Click="RemoveInviteTradeWhiteListButton_OnClick"/>

                                    <Label Grid.Row="1"
                                           Grid.Column="0"
                                           Content="Whitelist: "
                                           Margin="3"
                                           ToolTipService.ToolTip="Names allowed to send party invites and trade requests."/>
                                    <ListBox x:Name="InviteTradeWhiteListListBox"
                                             Grid.Row="1"
                                             Grid.Column="1"
                                             Grid.ColumnSpan="3"
                                             ItemsSource="{Binding Path=InviteTradeWhiteList, Mode=TwoWay}"
                                             SelectionChanged="InviteTradeWhiteListListBox_SelectionChanged"
                                             MinHeight="100"/>
                                </Grid>
                            </StackPanel>
                        </Expander>

                        <!-- Loot Blacklist -->
                        <Expander Header="Loot Blacklist" IsExpanded="False" Margin="5">
                            <StackPanel VerticalAlignment="Top" Margin="5">
                                <TextBlock Text="Prevent specific items from being picked up, even if visible."
                                           Margin="5" FontStyle="Italic" Foreground="Gray" TextWrapping="Wrap"/>
                                
                                <Grid Margin="5">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Type Selection -->
                                    <Label Grid.Row="0" Grid.Column="0" Content="Type:" VerticalAlignment="Center"/>
                                    <StackPanel Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="3">
                                        <RadioButton x:Name="BlacklistByName" Content="By Name" IsChecked="True"
                                                     GroupName="BlacklistType" Margin="0,0,15,0"
                                                     ToolTip="Block by display name (e.g., 'Scroll of Wisdom')"/>
                                        <RadioButton x:Name="BlacklistByMetadata" Content="By Metadata"
                                                     GroupName="BlacklistType"
                                                     ToolTip="Block by metadata (e.g., 'Metadata/Items/Currency/CurrencyIdentification')"/>
                                    </StackPanel>

                                    <!-- Input Field -->
                                    <Label Grid.Row="1" Grid.Column="0" Content="Item:" VerticalAlignment="Center"/>
                                    <TextBox x:Name="LootBlacklistTextBox" Grid.Row="1" Grid.Column="1"
                                             MinWidth="200" Margin="3" VerticalAlignment="Center"/>
                                    
                                    <!-- Action Buttons -->
                                    <StackPanel Grid.Row="1" Grid.Column="2" Orientation="Horizontal" Margin="3">
                                        <Button x:Name="AddLootBlacklistButton" Content="Add" MinWidth="60"
                                                Margin="0,0,3,0" Click="AddLootBlacklistButton_OnClick"
                                                ToolTip="Add to blacklist"/>
                                        <Button x:Name="RemoveLootBlacklistButton" Content="Remove" MinWidth="60"
                                                Click="RemoveLootBlacklistButton_OnClick"
                                                ToolTip="Remove selected from blacklist"/>
                                    </StackPanel>

                                    <!-- Blacklist Display -->
                                    <Label Grid.Row="2" Grid.Column="0" Content="Blacklist:"
                                           VerticalAlignment="Top" Margin="0,5,0,0"/>
                                    <ListBox x:Name="LootBlacklistListBox" Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2"
                                             MinHeight="100" MaxHeight="200" Margin="3,5,3,3"
                                             ItemsSource="{Binding Path=LootBlacklist, Mode=TwoWay}"
                                             SelectionChanged="LootBlacklistListBox_SelectionChanged"/>

                                    <!-- Examples -->
                                    <TextBlock Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="3" Margin="5"
                                               FontSize="10" Foreground="Gray" TextWrapping="Wrap">
                                        <Run Text="Examples: "/>
                                        <LineBreak/>
                                        <Run Text="• Name: 'Scroll of Wisdom', 'Portal Scroll'"/>
                                        <LineBreak/>
                                        <Run Text="• Metadata: 'Metadata/Items/Currency/CurrencyIdentification'"/>
                                    </TextBlock>
                                </Grid>
                            </StackPanel>
                        </Expander>

                        <!-- Ultimatum (Collapsible) -->
                        <Expander Header="Ultimatum Settings" IsExpanded="False" Margin="5">
                            <StackPanel>
                                <CheckBox Content="Portal After Ultimatum" IsChecked="{Binding ShouldLootUltimatum, Mode=TwoWay}" ToolTip="If enabled, the bot will search for a portal for a configurable amount of time after an Ultimatum is completed."/>
                                <WrapPanel>
                                    <Label Content="Portal Search Time: "/>
                                    <Slider Name="SlUltimatumLootTimer" Minimum="1" Maximum="60" Value="{Binding UltimatumLootTimer, Mode=TwoWay}" Width="150" TickFrequency="1" IsSnapToTickEnabled="True"/>
                                    <TextBox Text="{Binding ElementName=SlUltimatumLootTimer, Path=Value}" Width="30"/>
                                    <Label Content="seconds"/>
                                </WrapPanel>
                            </StackPanel>
                        </Expander>

                        <!-- Trade Settings (Collapsible) - NEW -->
                        <Expander Header="Trade Settings" IsExpanded="False" Margin="5">
                            <StackPanel>
                                <CheckBox Content="Enable Trade Debug Log"
                                          IsChecked="{Binding EnableTradeDebugLog, Mode=TwoWay}"
                                          Margin="5"
                                          ToolTip="If enabled, detailed trade logs will be shown for debugging purposes."/>
                                <Expander Header="Exclude Specific Inventory Slots" IsExpanded="False" Margin="5">
                                    <StackPanel>
                                        <TextBlock Text="Check slots to exclude from trading (items will be kept):"
                                                   Margin="5" FontWeight="SemiBold"/>
                                        <TextBlock Text="Useful for protecting flasks, currency, or important items"
                                                   FontStyle="Italic" Foreground="Gray" Margin="5,0,5,5"/>
                                        
                                        <!-- 12x5 Inventory Grid -->
                                        <Grid Name="TradeSlotGrid" HorizontalAlignment="Center" Margin="10">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="20"/>
                                                <ColumnDefinition Width="20"/>
                                                <ColumnDefinition Width="20"/>
                                                <ColumnDefinition Width="20"/>
                                                <ColumnDefinition Width="20"/>
                                                <ColumnDefinition Width="20"/>
                                                <ColumnDefinition Width="20"/>
                                                <ColumnDefinition Width="20"/>
                                                <ColumnDefinition Width="20"/>
                                                <ColumnDefinition Width="20"/>
                                                <ColumnDefinition Width="20"/>
                                                <ColumnDefinition Width="20"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="20"/>
                                                <RowDefinition Height="20"/>
                                                <RowDefinition Height="20"/>
                                                <RowDefinition Height="20"/>
                                                <RowDefinition Height="20"/>
                                            </Grid.RowDefinitions>
                                            <!-- Checkboxes will be generated in code-behind -->
                                        </Grid>
                                        
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="10,5">
                                            <Button Content="Clear All" Width="80" Height="25" Margin="3" Click="ClearAllSlots_Click"/>
                                            <Button Content="Exclude Left Column" Width="120" Height="25" Margin="3" Click="ExcludeLeftColumn_Click"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Expander>
                            </StackPanel>
                        </Expander>
                   </StackPanel>
                </ScrollViewer>
            </TabItem>
            <TabItem Header="Auras"
                     HorizontalAlignment="Left"
                     VerticalAlignment="Top">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <GroupBox Grid.Row="0"
                              Grid.Column="0"
                              Grid.ColumnSpan="2"
                              BorderThickness="2"
                              Margin="5,5,10,0"
                              Header="Aspects">
                        <StackPanel>
                            <CheckBox Content="Use Aspect of the Avian"
                                      Margin="10,0,10,0"
                                      IsChecked="{Binding Path=EnableAspectsOfTheAvian, Mode=TwoWay}"
                                      VerticalAlignment="Center"
                                      ToolTip="Should use Aspect of the Avian"></CheckBox>
                            <CheckBox Content="Use Aspect of the Cat"
                                      Margin="10,0,10,0"
                                      IsChecked="{Binding Path=EnableAspectsOfTheCat, Mode=TwoWay}"
                                      VerticalAlignment="Center"
                                      ToolTip="Should use Aspect of the Cat"></CheckBox>
                            <CheckBox Content="Use Aspect of the Crab"
                                      Margin="10,0,10,0"
                                      IsChecked="{Binding Path=EnableAspectsOfTheCrab, Mode=TwoWay}"
                                      VerticalAlignment="Center"
                                      ToolTip="Should use Aspect of the Crab"></CheckBox>
                            <CheckBox Content="Use Aspect of the Spider"
                                      Margin="10,0,10,0"
                                      IsChecked="{Binding Path=EnableAspectsOfTheSpider, Mode=TwoWay}"
                                      VerticalAlignment="Center"
                                      ToolTip="Should use Aspect of the Spider"></CheckBox>
                        </StackPanel>

                    </GroupBox>

                    <Label Grid.Row="1"
                           Grid.Column="0"
                           Grid.ColumnSpan="2"
                           FontWeight="Bold"
                           Content="The bot will try to cast all available Auras and AurificedCurses automatically."/>
                    <Label Grid.Row="2"
                           Grid.Column="0"
                           Grid.ColumnSpan="2"
                           FontWeight="Bold"
                           Content="If you use the Flesh and Stone skill, use this button to select your prefered stance."/>
                    <Button Grid.Row="3"
                            Grid.Column="0"
                            FontWeight="Bold"
                            Content="Change Stance"
                            Click="ChangeStance_OnClick"
                            Margin="5,1,25,1"></Button>
                    <Border BorderThickness="1"
                            BorderBrush="White"
                            CornerRadius="10"
                            Grid.Row="3"
                            Grid.Column="1">
                        <Label FontWeight="Bold"
                               Content="{Binding Path=BloorOrSand}"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"></Label>
                    </Border>

                </Grid>
            </TabItem>
            <TabItem Header="Flasks"
                     HorizontalAlignment="Left"
                     VerticalAlignment="Top">
                <DataGrid CanUserSortColumns="False"
                          ItemsSource="{Binding Path=Flasks, Mode=TwoWay}"
                          AutoGenerateColumns="False"
                          AllowDrop="False"
                          CanUserAddRows="False"
                          VerticalAlignment="Top"
                          Margin="0,5,0,0">
                    <DataGrid.Columns>
                        <DataGridTemplateColumn Header="Enabled">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <CheckBox HorizontalAlignment="Center"
                                                  IsChecked="{Binding Path=Enabled, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                  ToolTip="Enabled ?"
                                                  Width="Auto"/>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <!--<DataGridCheckBoxColumn Header="Enabled" Binding="{Binding Path=Enabled}" Width="Auto"></DataGridCheckBoxColumn>-->
                        <DataGridTemplateColumn Header="Slot">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Label Content="{Binding Path=Slot, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Center"></Label>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Header="UseEs">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <CheckBox HorizontalAlignment="Center"
                                                  IsChecked="{Binding Path=UseEs, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                  ToolTip="Use energy shield as threshold instead of life"
                                                  Width="Auto"/>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <!--<DataGridCheckBoxColumn Header="UseEs" Binding="{Binding Path=UseEs}" Width="Auto"></DataGridCheckBoxColumn>-->
                        <DataGridTemplateColumn Header="UseMana">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <CheckBox HorizontalAlignment="Center"
                                                  IsChecked="{Binding Path=UseMana, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                  ToolTip="Use mana as threshold instead of life"
                                                  Width="Auto"/>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <!--<DataGridCheckBoxColumn Header="UseMana" Binding="{Binding Path=UseMana}" Width="Auto"></DataGridCheckBoxColumn>-->
                        <DataGridTemplateColumn Header="Threshold">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <WrapPanel>
                                        <Slider Name="SlThreshold"
                                                Minimum="0"
                                                Margin="0,5,0,0"
                                                Width="160"
                                                Value="{Binding Path=Threshold, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                TickFrequency="1"
                                                IsSnapToTickEnabled="True"
                                                SmallChange="1"
                                                LargeChange="1"
                                                Maximum="101"
                                                AutoToolTipPrecision="1"
                                                VerticalAlignment="Center"
                                                ToolTip="This flask will be triggered when the selected property (Life, Es, Mana) is under this percent. set to 101 to always trigger."/>
                                        <TextBox Name="TbThreshold"
                                                 Text="{Binding ElementName=SlThreshold, Path=Value}"
                                                 Width="40"
                                                 HorizontalAlignment="Left"
                                                 Margin="0,5,0,0"
                                                 VerticalAlignment="Center"/>
                                    </WrapPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Header="IgnoreEffect">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <CheckBox HorizontalAlignment="Center"
                                                  IsChecked="{Binding Path=IgnoreEffect, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                  ToolTip="Ignore the Effect duration when deciding if to use this flask, use it in conjunction with Cooldown to trigger this flask each x ms."
                                                  Width="Auto"/>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Header="Cooldown (Ms)">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <WrapPanel>
                                        <Slider Name="SlCooldown"
                                                Minimum="0"
                                                Margin="0,5,0,0"
                                                Width="160"
                                                Value="{Binding Path=Cooldown, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                TickFrequency="1"
                                                IsSnapToTickEnabled="True"
                                                SmallChange="1"
                                                LargeChange="1"
                                                Maximum="15000"
                                                AutoToolTipPrecision="1"
                                                VerticalAlignment="Center"
                                                ToolTip="Cooldown time for this flask. The flask will be used once every x milliseconds as per delay configuration, Pls note, if the option IgnoreEffect is not selected, the flask will newer be used till the flask effect wear off, regardless for the Cooldown configuration.."/>
                                        <TextBox Name="TbCooldown"
                                                 Text="{Binding ElementName=SlCooldown, Path=Value}"
                                                 MinWidth="40"
                                                 HorizontalAlignment="Left"
                                                 Margin="0,5,0,0"
                                                 VerticalAlignment="Center"/>
                                    </WrapPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
            <TabItem Header="Defensive Skills"
                     HorizontalAlignment="Left"
                     VerticalAlignment="Top">
                <ScrollViewer VerticalScrollBarVisibility="Auto"
                              HorizontalScrollBarVisibility="Auto">
                    <DataGrid CanUserSortColumns="False"
                              ItemsSource="{Binding Path=DefensiveSkills, Mode=TwoWay}"
                              AutoGenerateColumns="False"
                              AllowDrop="False"
                              VerticalAlignment="Top"
                              Margin="0,5,0,0">
                        <DataGrid.Columns>
                            <DataGridCheckBoxColumn Header="Enabled"
                                                    Binding="{Binding Path=Enabled, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Width="Auto"></DataGridCheckBoxColumn>
                            <DataGridTextColumn Header="Skill Name"
                                                Binding="{Binding Path=Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Width="Auto"></DataGridTextColumn>
                            <DataGridCheckBoxColumn Header="UseEs"
                                                    Binding="{Binding Path=UseEs, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Width="Auto"></DataGridCheckBoxColumn>

                            <DataGridTemplateColumn Header="Threshold">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <WrapPanel>
                                            <Slider Name="SlThreshold"
                                                    Minimum="0"
                                                    Margin="0,5,0,0"
                                                    Width="160"
                                                    Value="{Binding Path=Threshold, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    TickFrequency="1"
                                                    IsSnapToTickEnabled="True"
                                                    SmallChange="1"
                                                    LargeChange="1"
                                                    Maximum="101"
                                                    AutoToolTipPrecision="1"
                                                    VerticalAlignment="Center"/>
                                            <TextBox Name="TbThreshold"
                                                     Text="{Binding ElementName=SlThreshold, Path=Value}"
                                                     Width="40"
                                                     HorizontalAlignment="Left"
                                                     Margin="0,5,0,0"
                                                     VerticalAlignment="Center"/>
                                        </WrapPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Header="SleepOnUse (Sec)">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <WrapPanel>
                                            <Slider Name="SlSleep"
                                                    Minimum="0"
                                                    Margin="0,5,0,0"
                                                    Width="100"
                                                    Value="{Binding Path=SleepSeconds, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    TickFrequency="0.1"
                                                    IsSnapToTickEnabled="True"
                                                    SmallChange="0.1"
                                                    LargeChange="1"
                                                    Maximum="60"
                                                    AutoToolTipPrecision="1"
                                                    VerticalAlignment="Center"/>
                                            <TextBox Name="TbSleep"
                                                     Text="{Binding ElementName=SlSleep, Path=Value}"
                                                     Width="40"
                                                     HorizontalAlignment="Left"
                                                     Margin="0,5,0,0"
                                                     VerticalAlignment="Center"/>
                                        </WrapPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridCheckBoxColumn Header="CastOnParty"
                                                    Binding="{Binding Path=CastOnLeader, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Width="Auto"></DataGridCheckBoxColumn>

                            <DataGridTemplateColumn Header="Link Whitelist">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <WrapPanel>
                                            <TextBox Name="linkWhitelist"
                                                     Text="{Binding Path=LinkWhitelist, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                     MinWidth="100"
                                                     MaxWidth="200"
                                                     Width="auto"
                                                     HorizontalAlignment="Left"
                                                     Margin="0,5,0,0"
                                                     VerticalAlignment="Center"
                                                     ToolTip="List of names, coma separated, of player that will recieve the Link cast. Ex: name1,name2,name3. PLS NOTE: if this field is empty, the link skill will be used on leader only as usual."/>
                                        </WrapPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Header="Remove">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Click="RemoveDefensiveSkillRule"
                                                VerticalAlignment="Center">X</Button>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </ScrollViewer>
            </TabItem>
            <TabItem Header="Level Gems"
                     HorizontalAlignment="Left"
                     VerticalAlignment="Top">
                <StackPanel VerticalAlignment="Top"
                            Margin="0,5,0,0">
                    <CheckBox Name="DebugStatementsCheckBox"
                              IsChecked="{Binding Path=GemDebugStatements, Mode=TwoWay}"
                              ToolTip="If enabled, it will log some debug informations"
                              Content="Gem Debug Info."></CheckBox>
                    <CheckBox Name="LevelGems"
                              IsChecked="{Binding Path=LevelGems, Mode=TwoWay}"
                              ToolTipService.ToolTip="If selected, all equipped gems will be leveled automatically (except those in the ignore list)."
                              Content="Level Gems"></CheckBox>
                    <CheckBox Name="UseLevelAllButton"
                              IsChecked="{Binding Path=UseLevelAllButton, Mode=TwoWay}"
                              ToolTipService.ToolTip="If enabled and 2+ gems are ready to level, use the 'Level All' button. Otherwise, level gems one at a time."
                              Content="Use the 'Level All' Button"
                              Margin="15,0,0,0"></CheckBox>
                   <Grid>
                       <Grid.RowDefinitions>
                           <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Label Grid.Row="0"
                               Grid.Column="0"
                               Content="Gem to Ignore: "
                               Margin="3"
                               ToolTipService.ToolTip="The skillgem name to add/remove from the ignore list."/>
                        <TextBox x:Name="GlobalNameIgnoreTextBox"
                                 Grid.Row="0"
                                 Grid.Column="1"
                                 Width="160"/>
                        <Button x:Name="AddGlobalNameIgnoreButton"
                                Grid.Row="0"
                                Grid.Column="2"
                                Content="Add"
                                Margin="3,5,3,1"
                                ToolTipService.ToolTip="Adds the skillgem name to the ignore list. NOTE: you can stop leveling a gem to a specific level separating the name and the target level with a coma Ex. Added Chaos Damage Support,5 "
                                Click="AddGlobalNameIgnoreButton_OnClick"/>
                        <Button x:Name="RemoveGlobalNameIgnoreButton"
                                Grid.Row="0"
                                Grid.Column="3"
                                Content="Remove"
                                Margin="3,5,3,1"
                                ToolTipService.ToolTip="Removes the skillgem name to the ignore list. Note to fast remove a gem, click on it in the list and the name will appear here."
                                Click="RemoveGlobalNameIgnoreButton_OnClick"/>

                        <Label Grid.Row="1"
                               Grid.Column="0"
                               Content="Gem to Ignore List: "
                               Margin="3"
                               ToolTipService.ToolTip="A list of skillgem names to ignore from leveling."/>
                        <ListBox x:Name="GlobalNameIgnoreListListBox"
                                 Grid.Row="1"
                                 Grid.Column="1"
                                 Grid.ColumnSpan="3"
                                 ItemsSource="{Binding Path=GlobalNameIgnoreList, Mode=TwoWay}"
                                 SelectionChanged="GlobalNameIgnoreListListBox_SelectionChanged"/>
                    </Grid>

                </StackPanel>
            </TabItem>
            <TabItem Header="Chat Commands"
                     HorizontalAlignment="Left"
                     VerticalAlignment="Top">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Label Content=""
                           Grid.Row="0"
                           Grid.Column="0"
                           HorizontalAlignment="Center"></Label>
                    <Label Content="On"
                           Grid.Row="0"
                           Grid.Column="1"
                           HorizontalAlignment="Center"></Label>
                    <Label Content="Off"
                           Grid.Row="0"
                           Grid.Column="2"
                           HorizontalAlignment="Center"></Label>
                    <Label Content="Teleport to Leader: "
                           Grid.Row="1"
                           Grid.Column="0"/>
                    <TextBox Text="{Binding Path=TeleportToLeaderChatCommand, Mode=TwoWay}"
                             MinWidth="100"
                             Grid.Row="1"
                             Grid.Column="1"
                             ToolTip="The follower will react to this message (if the message come from the party leader in whisper or group chat) by trying to teleport to the leader zone."/>

                    <Label Content="Follow: "
                           Grid.Row="2"
                           Grid.Column="0"/>
                    <TextBox Text="{Binding Path=StartFollowChatCommand, Mode=TwoWay}"
                             MinWidth="100"
                             Grid.Row="2"
                             Grid.Column="1"
                             ToolTip="The follower will react to this message (if the message come from the party leader in whisper or group chat) by restart following the leader."/>
                    <TextBox Text="{Binding Path=StopFollowChatCommand, Mode=TwoWay}"
                             MinWidth="100"
                             Grid.Row="2"
                             Grid.Column="2"
                             ToolTip="The follower will react to this message (if the message come from the party leader in whisper or group chat) by stop following the leader, the follower will still perform common actions like cast auras, use flasks, use skills, loot or fight if enabled."/>

                    <Label Content="Loot: "
                           Grid.Row="3"
                           Grid.Column="0"/>
                    <TextBox Text="{Binding Path=StartLootChatCommand, Mode=TwoWay}"
                             MinWidth="100"
                             Grid.Row="3"
                             Grid.Column="1"
                             ToolTip="The follower will react to this message (if the message come from the party leader in whisper or group chat) by turning on the loot feature."/>
                    <TextBox Text="{Binding Path=StopLootChatCommand, Mode=TwoWay}"
                             MinWidth="100"
                             Grid.Row="3"
                             Grid.Column="2"
                             ToolTip="The follower will react to this message (if the message come from the party leader in whisper or group chat) by turning off the loot feature."/>

                    <Label Content="Attack: "
                           Grid.Row="4"
                           Grid.Column="0"/>
                    <TextBox Text="{Binding Path=StartAttackChatCommand, Mode=TwoWay}"
                             MinWidth="100"
                             Grid.Row="4"
                             Grid.Column="1"
                             ToolTip="The follower will react to this message (if the message come from the party leader in whisper or group chat) by turning on the fight feature."/>
                    <TextBox Text="{Binding Path=StopAttackChatCommand, Mode=TwoWay}"
                             MinWidth="100"
                             Grid.Row="4"
                             Grid.Column="2"
                             ToolTip="The follower will react to this message (if the message come from the party leader in whisper or group chat) by turning off the fight feature."/>

                    <Label Content="Sentinel: "
                           Grid.Row="5"
                           Grid.Column="0"/>
                    <TextBox Text="{Binding Path=StartSentinelChatCommand, Mode=TwoWay}"
                             MinWidth="100"
                             Grid.Row="5"
                             Grid.Column="1"
                             ToolTip="The follower will react to this message (if the message come from the party leader in whisper or group chat) by turning on the sentinel feature."/>
                    <TextBox Text="{Binding Path=StopSentinelChatCommand, Mode=TwoWay}"
                             MinWidth="100"
                             Grid.Row="5"
                             Grid.Column="2"
                             ToolTip="The follower will react to this message (if the message come from the party leader in whisper or group chat) by turning off the sentinel feature."/>

                    <Label Content="Auto Teleport: "
                           Grid.Row="6"
                           Grid.Column="0"/>
                    <TextBox Text="{Binding Path=StartAutoTeleportChatCommand, Mode=TwoWay}"
                             MinWidth="100"
                             Grid.Row="6"
                             Grid.Column="1"
                             ToolTip="The follower will react to this message (if the message come from the party leader in whisper or group chat) by turning on the Don't Port Out of Map feature."/>
                    <TextBox Text="{Binding Path=StopAutoTeleportChatCommand, Mode=TwoWay}"
                             MinWidth="100"
                             Grid.Row="6"
                             Grid.Column="2"
                             ToolTip="The follower will react to this message (if the message come from the party leader in whisper or group chat) by turning off the Don't Port Out of Map feature."/>

                    <Label Content="Enter Portal: "
                           Grid.Row="7"
                           Grid.Column="0"/>
                    <TextBox Text="{Binding Path=EnterPortalChatCommand, Mode=TwoWay}"
                             MinWidth="100"
                             Grid.Row="7"
                             Grid.Column="1"
                             ToolTip="The follower will react to this message (if the message come from the party leader in whisper or group chat) by trying to enter a nearby portal."/>
                </Grid>
            </TabItem>
            <TabItem Header="Overlay"
                     HorizontalAlignment="Left"
                     VerticalAlignment="Top">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Label Grid.Row="0"
                           Grid.Column="0"
                           Content="Enable Overlay: "
                           Margin="3,5,3,1"/>
                    <CheckBox Grid.Row="0"
                              Grid.Column="1"
                              Margin="3"
                              IsChecked="{Binding EnableOverlay, Mode=TwoWay}"
                              ToolTipService.ToolTip="Enable and disable the Overlay drawing."/>

                    <Label Grid.Row="1"
                           Grid.Column="0"
                           Content="DrawInBackground: "
                           Margin="3,5,3,1"/>
                    <CheckBox Grid.Row="1"
                              Grid.Column="1"
                              Margin="3"
                              IsChecked="{Binding DrawInBackground, Mode=TwoWay}"
                              ToolTipService.ToolTip="If enabled, the Overlay is draw even when the game is not the top most foreground window."/>

                    <Label Grid.Row="2"
                           Grid.Column="0"
                           Content="Draw Mobs: "
                           Margin="3,5,3,1"/>
                    <CheckBox Grid.Row="2"
                              Grid.Column="1"
                              Margin="3"
                              IsChecked="{Binding DrawMobs, Mode=TwoWay}"
                              ToolTipService.ToolTip="Draw the mobs around you."/>

                    <Label Grid.Row="3"
                           Grid.Column="0"
                           Content="Draw Corpses: "
                           Margin="3,5,3,1"/>
                    <CheckBox Grid.Row="3"
                              Grid.Column="1"
                              Margin="3"
                              IsChecked="{Binding DrawCorpses, Mode=TwoWay}"
                              ToolTipService.ToolTip="Draw the Corpses around you."/>

                    <Label Content="Overlay Fps: "
                           Grid.Row="4"
                           Grid.Column="0"
                           Margin="3,5,3,1"/>
                    <WrapPanel Grid.Row="4"
                               Grid.Column="1"
                               Margin="3">
                        <Slider Name="SlFPS"
                                Minimum="0"
                                Margin="0,5,0,0"
                                Width="160"
                                Value="{Binding Path=FPS, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                TickFrequency="1"
                                IsSnapToTickEnabled="True"
                                SmallChange="1"
                                LargeChange="1"
                                Maximum="100"
                                AutoToolTipPrecision="1"
                                VerticalAlignment="Center"
                                ToolTip="Change the Overlay draw frequency, higher number, higher fps and higher resource consumption."/>
                        <TextBox Name="TbFPS"
                                 Text="{Binding ElementName=SlFPS, Path=Value}"
                                 MinWidth="40"
                                 HorizontalAlignment="Left"
                                 Margin="0,5,0,0"
                                 VerticalAlignment="Center"/>
                    </WrapPanel>

                    <Label Content="Overlay X Position: "
                           Grid.Row="5"
                           Grid.Column="0"
                           Margin="3,5,3,1"/>
                    <WrapPanel Grid.Row="5"
                               Grid.Column="1"
                               Margin="3">
                        <Slider Name="SlXPos"
                                Minimum="0"
                                Margin="0,5,0,0"
                                Width="160"
                                Value="{Binding Path=OverlayXCoord, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                TickFrequency="1"
                                IsSnapToTickEnabled="True"
                                SmallChange="1"
                                LargeChange="1"
                                Maximum="5000"
                                AutoToolTipPrecision="1"
                                VerticalAlignment="Center"
                                ToolTip="Change the Overlay draw X position."/>
                        <TextBox Name="TbXPos"
                                 Text="{Binding ElementName=SlXPos, Path=Value}"
                                 MinWidth="40"
                                 HorizontalAlignment="Left"
                                 Margin="0,5,0,0"
                                 VerticalAlignment="Center"/>
                    </WrapPanel>

                    <Label Content="Overlay Y Position: "
                           Grid.Row="6"
                           Grid.Column="0"
                           Margin="3,5,3,1"/>
                    <WrapPanel Grid.Row="6"
                               Grid.Column="1"
                               Margin="3">
                        <Slider Name="SlYPos"
                                Minimum="0"
                                Margin="0,5,0,0"
                                Width="160"
                                Value="{Binding Path=OverlayYCoord, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                TickFrequency="1"
                                IsSnapToTickEnabled="True"
                                SmallChange="1"
                                LargeChange="1"
                                Maximum="5000"
                                AutoToolTipPrecision="1"
                                VerticalAlignment="Center"
                                ToolTip="Change the Overlay draw Y position."/>
                        <TextBox Name="TbYPos"
                                 Text="{Binding ElementName=SlYPos, Path=Value}"
                                 MinWidth="40"
                                 HorizontalAlignment="Left"
                                 Margin="0,5,0,0"
                                 VerticalAlignment="Center"/>
                    </WrapPanel>

                    <Label Content="Overlay Transparency: "
                           Grid.Row="7"
                           Grid.Column="0"
                           Margin="3,5,3,1"/>
                    <WrapPanel Grid.Row="7"
                               Grid.Column="1"
                               Margin="3">
                        <Slider Name="SlTransparency"
                                Minimum="0"
                                Margin="0,5,0,0"
                                Width="160"
                                Value="{Binding Path=OverlayTransparency, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                TickFrequency="1"
                                IsSnapToTickEnabled="True"
                                SmallChange="1"
                                LargeChange="1"
                                Maximum="255"
                                AutoToolTipPrecision="1"
                                VerticalAlignment="Center"
                                ToolTip="Change the Overlay background transparency."/>
                        <TextBox Name="TbTransparency"
                                 Text="{Binding ElementName=SlTransparency, Path=Value}"
                                 MinWidth="40"
                                 HorizontalAlignment="Left"
                                 Margin="0,5,0,0"
                                 VerticalAlignment="Center"/>
                    </WrapPanel>
                </Grid>
            </TabItem>
            <TabItem Header="Custom Skills" HorizontalAlignment="Left" VerticalAlignment="Top">
    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
        <StackPanel Orientation="Vertical" Margin="10">
            <CheckBox Content="Enable Phase Run" IsChecked="{Binding EnablePhaseRun, Mode=TwoWay}" Margin="2"/>
            <StackPanel Orientation="Horizontal" Margin="2">
                <CheckBox Content="Enable Guard Skill" IsChecked="{Binding EnableGuardSkill, Mode=TwoWay}" VerticalAlignment="Center"/>
                <Label Content="Skill Name:" Margin="10,0,0,0" VerticalAlignment="Center"/>
                <TextBox Width="140" Margin="5,0,0,0" VerticalAlignment="Center" Text="{Binding GuardSkillName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ToolTip="Enter the name of the Guard Skill to use (e.g., Molten Shell, Steelskin)."/>
            </StackPanel>
            <StackPanel Orientation="Horizontal" Margin="2">
                <CheckBox Content="Enable Guardian's Blessing Handler" IsChecked="{Binding EnableGuardiansBlessingHandler, Mode=TwoWay}" VerticalAlignment="Center"/>
                <Label Content="Minion Name:" Margin="10,0,0,0" VerticalAlignment="Center"/>
                <TextBox Width="140" Margin="5,0,0,0" VerticalAlignment="Center" Text="{Binding GuardiansBlessingMinion, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ToolTip="Enter the name of the minion skill used for Guardian's Blessing (e.g., Summon Chaos Golem)."/>
            </StackPanel>
            <CheckBox Content="Enable Sentinel of Radiance Auto-Deploy" IsChecked="{Binding EnableSentinelUsage, Mode=TwoWay}" Margin="2"/>
            <StackPanel Orientation="Horizontal" Margin="2">
                <CheckBox Content="Enable Chaos Elixir" IsChecked="{Binding EnableChaosElixir, Mode=TwoWay}" VerticalAlignment="Center"/>
                <Label Content="Flask Slot:" Margin="10,0,0,0" VerticalAlignment="Center"/>
                <controls:NumericUpDown Value="{Binding ChaosElixirFlaskSlot, Mode=TwoWay}" Minimum="1" Maximum="5" Interval="1" Width="70" VerticalAlignment="Center"/>
            </StackPanel>
            <CheckBox Content="Enable Convocation" IsChecked="{Binding EnableConvocation, Mode=TwoWay}" Margin="2" ToolTip="Uses Convocation on cooldown."/>
            <StackPanel Orientation="Horizontal" Margin="2" VerticalAlignment="Center">
                <CheckBox Content="Enable Link Skill"
                          IsChecked="{Binding EnableLinkSkill, Mode=TwoWay}"
                          VerticalAlignment="Center"/>
                <Label Content="Additional Target(s):" Margin="10,0,0,0" VerticalAlignment="Center"/>
                <TextBox Width="140"
                         Margin="5,0,0,0"
                         VerticalAlignment="Center"
                         Text="{Binding LinkSkillAdditionalTargets, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         ToolTip="Enter player names, separated by commas, for additional link targets."/>
            </StackPanel>
            <Expander Header="Rejuvenation Totem" Margin="0,10,0,0" IsExpanded="True">
                <StackPanel Margin="15,5,0,0">
                    <CheckBox Content="Enable Rejuvenation Totem" IsChecked="{Binding EnableRejuvenationTotem, Mode=TwoWay}" FontWeight="Bold" Margin="2"/>
                    <StackPanel Margin="15,5,0,0">
                        <CheckBox Content="Always Use in Ultimatum" IsChecked="{Binding RejuvenationTotemAlwaysUseInUltimatum, Mode=TwoWay}" Margin="2" ToolTip="Override health checks and always use totem during Ultimatum encounters."/>
                        <CheckBox Content="Always Use in Blight" IsChecked="{Binding RejuvenationTotemAlwaysUseInBlight, Mode=TwoWay}" Margin="2" ToolTip="Override health checks and always use totem during Blight encounters."/>
                        <Grid Margin="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Label Grid.Row="0" Grid.Column="0" Content="Leader Below Percent:" VerticalAlignment="Center" ToolTip="Cast totem when leader's health falls below this percentage."/>
                            <controls:NumericUpDown Grid.Row="0" Grid.Column="1" Value="{Binding RejuvenationTotemLeaderHealthPercent, Mode=TwoWay}" Minimum="0" Maximum="100" Interval="5" Width="90" VerticalAlignment="Center"/>
                            <Label Grid.Row="1" Grid.Column="0" Content="Follower Below Percent:" VerticalAlignment="Center" ToolTip="Cast totem when follower's health/ES falls below this percentage."/>
                            <controls:NumericUpDown Grid.Row="1" Grid.Column="1" Value="{Binding RejuvenationTotemFollowerHealthPercent, Mode=TwoWay}" Minimum="0" Maximum="100" Interval="5" Width="90" VerticalAlignment="Center"/>
                        </Grid>
                    </StackPanel>
                </StackPanel>
            </Expander>
            <Expander Header="Warcries" Margin="0,10,0,0" IsExpanded="True">
                <StackPanel Margin="15,5,0,0">
                    <StackPanel Orientation="Vertical" Margin="2">
                        <CheckBox Content="Enable Enduring Cry" IsChecked="{Binding EnableEnduringCry, Mode=TwoWay}" VerticalAlignment="Center"/>
                        <StackPanel Margin="15,5,0,0">
                            <CheckBox Content="Has Onslaught Cluster?" IsChecked="{Binding EnduringCryHasOnslaughtCluster, Mode=TwoWay}" VerticalAlignment="Center"/>
                        </StackPanel>
                    </StackPanel>
                    <CheckBox Content="Enable Seismic Cry" IsChecked="{Binding EnableSeismicCry, Mode=TwoWay}" Margin="2"/>
                    <CheckBox Content="Enable Battlemage's Cry" IsChecked="{Binding EnableBattlemageCry, Mode=TwoWay}" Margin="2"/>
                    <CheckBox Content="Enable Ancestral Cry" IsChecked="{Binding EnableAncestralCry, Mode=TwoWay}" Margin="2"/>
                    <CheckBox Content="Enable Intimidating Cry" IsChecked="{Binding EnableIntimidatingCry, Mode=TwoWay}" Margin="2"/>
                    <CheckBox Content="Enable Infernal Cry" IsChecked="{Binding EnableInfernalCry, Mode=TwoWay}" Margin="2"/>
                    <CheckBox Content="Enable Rallying Cry" IsChecked="{Binding EnableRallyingCry, Mode=TwoWay}" Margin="2"/>
                </StackPanel>
            </Expander>
            <Expander Header="Banner Management" Margin="0,10,0,0" IsExpanded="True">
                <StackPanel Margin="15,5,0,0">
                    <CheckBox Content="Enable Comprehensive Banner Control" IsChecked="{Binding EnableComprehensiveBanner, Mode=TwoWay}" FontWeight="Bold"/>
                    <StackPanel Margin="15,5,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- War Banner -->
                            <CheckBox Grid.Row="0" Grid.Column="0" Content="Use War Banner" IsChecked="{Binding UseWarBanner, Mode=TwoWay}" VerticalAlignment="Center"/>
                            <Label Grid.Row="0" Grid.Column="1" Content="Charges:" Margin="10,0,0,0" VerticalAlignment="Center"/>
                            <controls:NumericUpDown Grid.Row="0" Grid.Column="2" Value="{Binding WarBannerCharges, Mode=TwoWay}" Minimum="0" Maximum="200" Interval="1" Width="100" VerticalAlignment="Center"/>

                            <!-- Defiance Banner -->
                            <CheckBox Grid.Row="1" Grid.Column="0" Content="Use Defiance Banner" IsChecked="{Binding UseDefianceBanner, Mode=TwoWay}" VerticalAlignment="Center" Margin="0,5,0,0"/>
                            <Label Grid.Row="1" Grid.Column="1" Content="Charges:" Margin="10,5,0,0" VerticalAlignment="Center"/>
                            <controls:NumericUpDown Grid.Row="1" Grid.Column="2" Value="{Binding DefianceBannerCharges, Mode=TwoWay}" Minimum="0" Maximum="200" Interval="1" Width="100" VerticalAlignment="Center" Margin="0,5,0,0"/>

                            <!-- Dread Banner -->
                            <CheckBox Grid.Row="2" Grid.Column="0" Content="Use Dread Banner" IsChecked="{Binding UseDreadBanner, Mode=TwoWay}" VerticalAlignment="Center" Margin="0,5,0,0"/>
                            <Label Grid.Row="2" Grid.Column="1" Content="Charges:" Margin="10,5,0,0" VerticalAlignment="Center"/>
                            <controls:NumericUpDown Grid.Row="2" Grid.Column="2" Value="{Binding DreadBannerCharges, Mode=TwoWay}" Minimum="0" Maximum="200" Interval="1" Width="100" VerticalAlignment="Center" Margin="0,5,0,0"/>
                        </Grid>
                        <GroupBox Header="Trigger Conditions" Margin="0,10,0,0">
                            <StackPanel>
                                <CheckBox Content="Near Rares" IsChecked="{Binding UseBannersNearRares, Mode=TwoWay}" ToolTip="Use banners when near Rare monsters."/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <CheckBox Grid.Row="0" Grid.Column="0" Content="Near Uniques" IsChecked="{Binding UseBannersNearUniques, Mode=TwoWay}" ToolTip="Use banners when near Unique monsters." VerticalAlignment="Center"/>
                                    <CheckBox Grid.Row="0" Grid.Column="1" Content="Generate Valor" IsChecked="{Binding GenerateValorNearUniques, Mode=TwoWay}" ToolTip="Use Warcries to generate Valor when near Unique monsters." Margin="10,0,0,0" VerticalAlignment="Center"/>

                                    <CheckBox Grid.Row="1" Grid.Column="0" Content="In Ultimatum" IsChecked="{Binding UseBannersInUltimatum, Mode=TwoWay}" ToolTip="Use banners during Ultimatum encounters. Overrides Near Rares/Uniques." VerticalAlignment="Center"/>
                                    <CheckBox Grid.Row="1" Grid.Column="1" Content="Generate Valor" IsChecked="{Binding GenerateValorInUltimatum, Mode=TwoWay}" ToolTip="Use Warcries to generate Valor during Ultimatum encounters." Margin="10,0,0,0" VerticalAlignment="Center"/>

                                    <CheckBox Grid.Row="2" Grid.Column="0" Content="In Blight" IsChecked="{Binding UseBannersInBlight, Mode=TwoWay}" ToolTip="Use banners during Blight encounters. Overrides Near Rares/Uniques." VerticalAlignment="Center"/>
                                    <CheckBox Grid.Row="2" Grid.Column="1" Content="Generate Valor" IsChecked="{Binding GenerateValorInBlight, Mode=TwoWay}" ToolTip="Use Warcries to generate Valor during Blight encounters." Margin="10,0,0,0" VerticalAlignment="Center"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </StackPanel>
            </Expander>
            <Expander Header="Minions" Margin="0,10,0,0" IsExpanded="True">
                <StackPanel Margin="15,5,0,0">
                    <Expander Header="Summon Raging Spirits" IsExpanded="True">
                        <StackPanel Margin="15,5,0,0">
                            <CheckBox Content="Enable Summon Raging Spirits" IsChecked="{Binding EnableSummonRagingSpirits, Mode=TwoWay}" FontWeight="Bold"/>
                            <StackPanel Orientation="Horizontal" Margin="15,2,2,2">
                                <Label Content="Min Spirits:" VerticalAlignment="Center" ToolTip="The minimum number of raging spirits to maintain."/>
                                <controls:NumericUpDown Value="{Binding MinRagingSpirits, Mode=TwoWay}" Minimum="1" Maximum="50" Interval="1" Width="90" VerticalAlignment="Center"/>
                                <Label Content="Custom Distance:" Margin="10,0,0,0" VerticalAlignment="Center" ToolTip="A custom distance from the leader to allow casting. Overrides the global Max Combat Distance for this skill."/>
                                <controls:NumericUpDown Value="{Binding SrsCustomDistance, Mode=TwoWay}" Minimum="1" Maximum="1000" Interval="5" Width="90" VerticalAlignment="Center"/>
                                <Label Content="Monster Distance:" Margin="10,0,0,0" VerticalAlignment="Center" ToolTip="The maximum distance to a monster to trigger casting."/>
                                <controls:NumericUpDown Value="{Binding SrsMonsterDistance, Mode=TwoWay}" Minimum="1" Maximum="1000" Interval="5" Width="90" VerticalAlignment="Center"/>
                                <CheckBox Content="Target Normal/Magic" IsChecked="{Binding SrsOnNormalMagic, Mode=TwoWay}" Margin="10,0,0,0" VerticalAlignment="Center" ToolTip="If checked, the skill will also be used when near normal or magic rarity monsters."/>
                            </StackPanel>
                        </StackPanel>
                    </Expander>
                    <Separator Margin="0,5,0,5"/>
                    <Expander Header="Summon Skeletons" IsExpanded="True">
                        <StackPanel Margin="15,5,0,0">
                            <CheckBox Content="Enable Summon Skeletons" IsChecked="{Binding EnableSummonSkeletons, Mode=TwoWay}" FontWeight="Bold"/>
                            <StackPanel Orientation="Horizontal" Margin="15,2,2,2">
                                <Label Content="Min Skeletons:" VerticalAlignment="Center" ToolTip="The minimum number of skeletons to maintain."/>
                                <controls:NumericUpDown Value="{Binding MinSkeletons, Mode=TwoWay}" Minimum="1" Maximum="50" Interval="1" Width="90" VerticalAlignment="Center"/>
                                <Label Content="Custom Distance:" Margin="10,0,0,0" VerticalAlignment="Center" ToolTip="A custom distance from the leader to allow casting. Overrides the global Max Combat Distance for this skill."/>
                                <controls:NumericUpDown Value="{Binding SkeletonsCustomDistance, Mode=TwoWay}" Minimum="1" Maximum="1000" Interval="5" Width="90" VerticalAlignment="Center"/>
                                <Label Content="Monster Distance:" Margin="10,0,0,0" VerticalAlignment="Center" ToolTip="The maximum distance to a monster to trigger casting."/>
                                <controls:NumericUpDown Value="{Binding SkeletonsMonsterDistance, Mode=TwoWay}" Minimum="1" Maximum="1000" Interval="5" Width="90" VerticalAlignment="Center"/>
                                <CheckBox Content="Target Normal/Magic" IsChecked="{Binding SkeletonsOnNormalMagic, Mode=TwoWay}" Margin="10,0,0,0" VerticalAlignment="Center" ToolTip="If checked, the skill will also be used when near normal or magic rarity monsters."/>
                            </StackPanel>
                        </StackPanel>
                    </Expander>
                </StackPanel>
            </Expander>
            <StackPanel Orientation="Vertical" Margin="2,5,2,2" DataContext="{x:Static settingsPath:FollowBotSettings.Instance}">
                <Border BorderBrush="Gray" BorderThickness="1" CornerRadius="3" Padding="5">
                    <StackPanel>
                        <Separator Margin="0,5,0,5"/>
                        <CheckBox Content="Enable Breach Graft 1" IsChecked="{Binding EnableBreachGraft1, Mode=TwoWay}" FontWeight="Bold"/>
                        <StackPanel Orientation="Horizontal" Margin="15,2,2,2">
                            <Label Content="Custom Distance:" Margin="10,0,0,0" VerticalAlignment="Center" ToolTip="A custom distance from the leader to allow casting. Overrides the global Max Combat Distance for this skill."/>
                            <controls:NumericUpDown Value="{Binding BreachGraft1CustomDistance, Mode=TwoWay}" Minimum="1" Maximum="1000" Interval="5" Width="90" VerticalAlignment="Center"/>
                            <Label Content="Monster Distance:" Margin="10,0,0,0" VerticalAlignment="center" ToolTip="The maximum distance to a monster to trigger casting."/>
                            <controls:NumericUpDown Value="{Binding BreachGraft1MonsterDistance, Mode=TwoWay}" Minimum="1" Maximum="1000" Interval="5" Width="90" VerticalAlignment="Center"/>
                            <CheckBox Content="Target Normal/Magic" IsChecked="{Binding BreachGraft1OnNormalMagic, Mode=TwoWay}" Margin="10,0,0,0" VerticalAlignment="Center" ToolTip="If checked, the skill will also be used when near normal or magic rarity monsters."/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </StackPanel>
        </StackPanel>
    </ScrollViewer>
</TabItem>
        </TabControl>
    </Grid>
</UserControl>
